/* –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø –î–õ–Ø –ú–û–ë–ò–õ–¨–ù–´–• –£–°–¢–†–û–ô–°–¢–í */

/* –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã –∫–∞—Ä—Ç—ã –¥–ª—è –≤—Å–µ—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ */
#map, #adminMap {
    width: 100% !important;
    height: 400px !important;
    min-height: 300px !important;
    max-height: 400px !important;
    position: relative !important;
    z-index: 1 !important;
    background: #f0f0f0 !important;
    border-radius: 0 !important;
}

/* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –∫–∞—Ä—Ç—ã */
.map-container {
    width: 100% !important;
    height: 400px !important;
    min-height: 300px !important;
    position: relative !important;
    overflow: hidden !important;
    border-radius: 15px !important;
    background: white !important;
    margin: 10px 0 !important;
    box-shadow: 0 4px 15px rgba(0,0,0,0.1) !important;
}

/* –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Å—Ç–∏–ª–∏ –¥–ª—è Leaflet */
.leaflet-container {
    width: 100% !important;
    height: 100% !important;
    position: relative !important;
    background: #f8f9fa !important;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif !important;
}

.leaflet-map-pane {
    position: relative !important;
    z-index: 1 !important;
}

.leaflet-tile-pane {
    filter: grayscale(100%) contrast(1.1) brightness(1.05) !important;
}

/* –£–±–∏—Ä–∞–µ–º —Ñ–∏–ª—å—Ç—Ä—ã —Å –º–∞—Ä–∫–µ—Ä–æ–≤ –∏ –∫–æ–Ω—Ç—Ä–æ–ª–æ–≤ */
.leaflet-marker-pane,
.leaflet-popup-pane,
.leaflet-control-container {
    filter: none !important;
}

/* –ú–û–ë–ò–õ–¨–ù–´–ï –ú–ê–†–ö–ï–†–´ */
.pb-marker {
    background: none !important;
    border: none !important;
    z-index: 1000 !important;
}

.pb-dot {
    width: 32px !important;
    height: 32px !important;
    border-radius: 50% !important;
    border: 3px solid white !important;
    box-shadow: 0 4px 12px rgba(0,0,0,0.3) !important;
    cursor: pointer !important;
    transition: all 0.3s ease !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    font-size: 14px !important;
    font-weight: bold !important;
    color: white !important;
    position: relative !important;
    touch-action: manipulation !important;
    z-index: 1001 !important;
}

.pb-dot:active,
.pb-dot.active {
    transform: scale(1.2) !important;
    box-shadow: 0 6px 20px rgba(0,0,0,0.4) !important;
    z-index: 1002 !important;
}

.pb-dot.available {
    background: linear-gradient(45deg, #4CAF50, #45a049) !important;
}

.pb-dot.collected {
    background: linear-gradient(45deg, #f44336, #e53935) !important;
}

.pb-dot.available::before {
    content: 'üì¶' !important;
}

.pb-dot.collected::before {
    content: '‚úÖ' !important;
}

/* –ú–û–ë–ò–õ–¨–ù–´–ï –ü–û–ü–ê–ü–´ */
.leaflet-popup {
    z-index: 2000 !important;
}

.leaflet-popup-content-wrapper {
    background: rgba(255, 255, 255, 0.98) !important;
    border-radius: 12px !important;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.15) !important;
    backdrop-filter: blur(15px) !important;
    border: 1px solid rgba(255, 255, 255, 0.2) !important;
    max-width: calc(100vw - 40px) !important;
    min-width: 250px !important;
}

.leaflet-popup-close-button {
    color: #6c757d !important;
    font-size: 24px !important;
    padding: 8px !important;
    width: 32px !important;
    height: 32px !important;
    line-height: 24px !important;
    text-align: center !important;
    transition: color 0.3s !important;
    font-weight: bold !important;
    z-index: 2001 !important;
}

.leaflet-popup-close-button:hover {
    color: #495057 !important;
    background: none !important;
}

.pb-popup {
    min-width: 250px !important;
    max-width: calc(100vw - 60px) !important;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif !important;
    font-size: 15px !important;
}

.pb-popup h3 {
    margin: 0 0 12px 0 !important;
    color: #333 !important;
    font-size: 1.1rem !important;
    font-weight: 600 !important;
}

.pb-status {
    margin: 8px 0 !important;
    font-weight: 600 !important;
    padding: 6px 12px !important;
    border-radius: 20px !important;
    text-align: center !important;
    font-size: 0.9rem !important;
}

.pb-status.available {
    background: #e8f5e8 !important;
    color: #2e7d32 !important;
}

.pb-status.collected {
    background: #ffebee !important;
    color: #c62828 !important;
}

/* –ö–û–ù–¢–†–û–õ–´ –ö–ê–†–¢–´ –î–õ–Ø –ú–û–ë–ò–õ–¨–ù–´–• */
.leaflet-control-zoom {
    margin-top: 10px !important;
    margin-left: 10px !important;
}

.leaflet-control-zoom a {
    background-color: rgba(255, 255, 255, 0.95) !important;
    color: #495057 !important;
    border: 1px solid rgba(108, 117, 125, 0.2) !important;
    backdrop-filter: blur(10px) !important;
    transition: all 0.3s !important;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1) !important;
    width: 40px !important;
    height: 40px !important;
    line-height: 40px !important;
    font-size: 20px !important;
    text-align: center !important;
}

.leaflet-control-zoom a:hover {
    background-color: #f8f9fa !important;
    color: #343a40 !important;
    transform: scale(1.05) !important;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15) !important;
}

/* –£–í–ï–î–û–ú–õ–ï–ù–ò–Ø –î–õ–Ø –ú–û–ë–ò–õ–¨–ù–´–• */
.pb-notification {
    position: fixed !important;
    top: 10px !important;
    left: 10px !important;
    right: 10px !important;
    z-index: 3000 !important;
    background: white !important;
    border-radius: 8px !important;
    padding: 16px 20px !important;
    box-shadow: 0 4px 20px rgba(0,0,0,0.15) !important;
    max-width: none !important;
    font-size: 14px !important;
    font-weight: 500 !important;
    display: flex !important;
    align-items: center !important;
    gap: 10px !important;
    animation: slideInMobile 0.3s ease-out !important;
}

.pb-notification.error {
    border-left: 4px solid #f44336 !important;
}

.pb-notification.success {
    border-left: 4px solid #4CAF50 !important;
}

.pb-notification.info {
    border-left: 4px solid #2196F3 !important;
}

.pb-notification button {
    background: none !important;
    border: none !important;
    font-size: 20px !important;
    cursor: pointer !important;
    color: #999 !important;
    padding: 0 !important;
    margin: 0 !important;
    margin-left: auto !important;
    min-width: 30px !important;
    height: 30px !important;
    flex-shrink: 0 !important;
}

@keyframes slideInMobile {
    from {
        transform: translateY(-100%);
        opacity: 0;
    }
    to {
        transform: translateY(0);
        opacity: 1;
    }
}

/* –ö–ù–û–ü–ö–ê –ì–ï–û–õ–û–ö–ê–¶–ò–ò */
.map-controls {
    display: flex !important;
    justify-content: center !important;
    align-items: center !important;
    background: rgba(255, 255, 255, 0.95) !important;
    border-radius: 15px !important;
    padding: 16px !important;
    margin: 15px 10px !important;
    backdrop-filter: blur(10px) !important;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1) !important;
}

.control-btn {
    width: 100% !important;
    max-width: 350px !important;
    background: linear-gradient(45deg, #4CAF50, #45a049) !important;
    color: white !important;
    border: none !important;
    padding: 16px 20px !important;
    border-radius: 12px !important;
    font-size: 1rem !important;
    font-weight: 600 !important;
    cursor: pointer !important;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    gap: 10px !important;
    position: relative !important;
    overflow: hidden !important;
    margin: 0 !important;
    min-height: 55px !important;
    box-shadow: 0 4px 15px rgba(76, 175, 80, 0.2) !important;
    touch-action: manipulation !important;
}

.control-btn:active {
    transform: translateY(1px) !important;
    box-shadow: 0 2px 8px rgba(76, 175, 80, 0.3) !important;
}

.control-btn:disabled {
    opacity: 0.6 !important;
    cursor: not-allowed !important;
    transform: none !important;
}

/* –ê–î–ê–ü–¢–ò–í–ù–û–°–¢–¨ –ü–û –†–ê–ó–ú–ï–†–ê–ú –≠–ö–†–ê–ù–ê */

/* –ü–ª–∞–Ω—à–µ—Ç—ã */
@media (max-width: 768px) and (min-width: 481px) {
    #map, #adminMap {
        height: 350px !important;
        min-height: 350px !important;
        max-height: 350px !important;
    }
    
    .map-container {
        height: 350px !important;
        min-height: 350px !important;
        margin: 10px 5px !important;
    }
    
    .pb-dot {
        width: 30px !important;
        height: 30px !important;
        font-size: 13px !important;
    }
    
    .leaflet-control-zoom a {
        width: 38px !important;
        height: 38px !important;
        line-height: 38px !important;
        font-size: 18px !important;
    }
}

/* –ë–æ–ª—å—à–∏–µ —Å–º–∞—Ä—Ç—Ñ–æ–Ω—ã */
@media (max-width: 480px) and (min-width: 361px) {
    #map, #adminMap {
        height: 320px !important;
        min-height: 320px !important;
        max-height: 320px !important;
    }
    
    .map-container {
        height: 320px !important;
        min-height: 320px !important;
        margin: 8px 3px !important;
    }
    
    .pb-dot {
        width: 28px !important;
        height: 28px !important;
        font-size: 12px !important;
    }
    
    .control-btn {
        font-size: 0.95rem !important;
        padding: 14px 18px !important;
        min-height: 50px !important;
    }
    
    .map-controls {
        padding: 14px !important;
        margin: 12px 8px !important;
    }
}

/* –ú–∞–ª–µ–Ω—å–∫–∏–µ —Å–º–∞—Ä—Ç—Ñ–æ–Ω—ã */
@media (max-width: 360px) {
    #map, #adminMap {
        height: 300px !important;
        min-height: 300px !important;
        max-height: 300px !important;
    }
    
    .map-container {
        height: 300px !important;
        min-height: 300px !important;
        margin: 5px 2px !important;
    }
    
    .pb-dot {
        width: 26px !important;
        height: 26px !important;
        font-size: 11px !important;
    }
    
    .control-btn {
        font-size: 0.9rem !important;
        padding: 12px 16px !important;
        min-height: 48px !important;
    }
    
    .map-controls {
        padding: 12px !important;
        margin: 10px 5px !important;
    }
    
    .pb-notification {
        top: 5px !important;
        left: 5px !important;
        right: 5px !important;
        padding: 12px 16px !important;
        font-size: 13px !important;
    }
    
    .leaflet-control-zoom a {
        width: 35px !important;
        height: 35px !important;
        line-height: 35px !important;
        font-size: 16px !important;
    }
}

/* iOS –°–ü–ï–¶–ò–§–ò–ß–ù–´–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø */
@supports (-webkit-touch-callout: none) {
    .leaflet-container {
        -webkit-transform: translate3d(0,0,0) !important;
        -webkit-perspective: 1000 !important;
        -webkit-backface-visibility: hidden !important;
    }
    
    .pb-dot {
        -webkit-transform: translate3d(0,0,0) !important;
        -webkit-backface-visibility: hidden !important;
    }
    
    .leaflet-popup-content-wrapper {
        -webkit-transform: translate3d(0,0,0) !important;
    }
}

/* ANDROID –°–ü–ï–¶–ò–§–ò–ß–ù–´–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø */
@media (max-width: 768px) {
    .leaflet-container {
        transform: translateZ(0) !important;
    }
    
    .leaflet-map-pane {
        transform: translateZ(0) !important;
    }
}

/* –í–´–°–û–ö–ê–Ø –ü–õ–û–¢–ù–û–°–¢–¨ –ü–ò–ö–°–ï–õ–ï–ô */
@media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
    .pb-dot {
        border-width: 2px !important;
        box-shadow: 0 2px 8px rgba(0,0,0,0.3) !important;
    }
    
    .leaflet-control-zoom a {
        border-width: 1px !important;
    }
}

/* –¢–ï–ú–ù–ê–Ø –¢–ï–ú–ê –î–õ–Ø –£–°–¢–†–û–ô–°–¢–í */
@media (prefers-color-scheme: dark) {
    .leaflet-control-zoom a {
        background-color: rgba(40, 40, 40, 0.95) !important;
        color: #ffffff !important;
        border-color: rgba(255, 255, 255, 0.2) !important;
    }
    
    .leaflet-popup-content-wrapper {
        background: rgba(40, 40, 40, 0.98) !important;
        color: #ffffff !important;
    }
    
    .pb-popup h3 {
        color: #ffffff !important;
    }
}

/* –û–¢–õ–ê–î–û–ß–ù–ê–Ø –ò–ù–§–û–†–ú–ê–¶–ò–Ø */
.mobile-debug {
    position: fixed !important;
    bottom: 10px !important;
    left: 10px !important;
    background: rgba(0,0,0,0.8) !important;
    color: white !important;
    padding: 8px 12px !important;
    border-radius: 6px !important;
    font-size: 11px !important;
    font-family: monospace !important;
    z-index: 9999 !important;
    display: none !important;
    max-width: calc(100vw - 20px) !important;
    word-wrap: break-word !important;
}

.mobile-debug.show {
    display: block !important;
}

/* –ü–†–ò–ù–£–î–ò–¢–ï–õ–¨–ù–´–ï –°–¢–ò–õ–ò –î–õ–Ø –ü–†–û–ë–õ–ï–ú–ù–´–• –£–°–¢–†–û–ô–°–¢–í */
.force-mobile-map {
    width: 100vw !important;
    height: 50vh !important;
    min-height: 300px !important;
    max-height: 400px !important;
    position: relative !important;
    overflow: hidden !important;
}

.force-mobile-map .leaflet-container {
    width: 100% !important;
    height: 100% !important;
}

/* ACCESSIBILITY */
@media (prefers-reduced-motion: reduce) {
    .pb-dot,
    .control-btn,
    .leaflet-control-zoom a {
        transition: none !important;
        animation: none !important;
    }
}

/* –ü–ï–ß–ê–¢–¨ */
@media print {
    .leaflet-control-container,
    .control-btn,
    .pb-notification {
        display: none !important;
    }
    
    #map {
        height: 400px !important;
        width: 100% !important;
    }
}
