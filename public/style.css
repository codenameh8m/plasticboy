/* Критические стили для первого рендера */
*,*::before,*::after{margin:0;padding:0;box-sizing:border-box}
body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);min-height:100vh;color:#333;-webkit-font-smoothing:antialiased}

/* Предотвращение FOUC */
body.loading .container>*:not(.header){opacity:0}
body.loaded .container>*{opacity:1;transition:opacity 0.3s ease}

.container{max-width:100%;margin:0 auto;padding:10px;min-height:100vh}

/* Оптимизированный заголовок */
.header{
    text-align:center;
    background:rgba(255,255,255,0.95);
    border-radius:20px;
    padding:20px;
    margin-bottom:20px;
    backdrop-filter:blur(10px);
    box-shadow:0 8px 32px rgba(0,0,0,0.1);
    will-change:transform
}

.header h1{
    font-size:2.5rem;
    font-weight:700;
    margin-bottom:10px;
    background:linear-gradient(45deg,#667eea,#764ba2);
    -webkit-background-clip:text;
    -webkit-text-fill-color:transparent;
    background-clip:text
}

.header p{font-size:1.1rem;color:#666;font-weight:500;margin-bottom:15px}

.admin-link{margin-top:15px}

.admin-btn-link{
    display:inline-block;
    background:linear-gradient(45deg,#667eea,#764ba2);
    color:white;
    text-decoration:none;
    padding:10px 20px;
    border-radius:12px;
    font-size:0.9rem;
    font-weight:600;
    transition:transform 0.2s ease;
    box-shadow:0 4px 15px rgba(102,126,234,0.3)
}

.admin-btn-link:hover{
    transform:translateY(-2px);
    text-decoration:none;
    color:white
}

/* Быстрая статистика */
.stats{
    display:flex;
    justify-content:space-around;
    background:rgba(255,255,255,0.95);
    border-radius:15px;
    padding:15px;
    margin-bottom:20px;
    backdrop-filter:blur(10px);
    box-shadow:0 4px 20px rgba(0,0,0,0.1)
}

.stat-item{text-align:center;flex:1}

.stat-number{
    display:block;
    font-size:2rem;
    font-weight:700;
    color:#667eea;
    margin-bottom:5px;
    will-change:transform;
    transition:transform 0.2s ease
}

.stat-label{font-size:0.9rem;color:#666;font-weight:500}

/* Оптимизированная карта */
.map-container{
    position:relative;
    background:white;
    border-radius:20px;
    overflow:hidden;
    box-shadow:0 8px 32px rgba(0,0,0,0.1);
    margin-bottom:20px;
    will-change:transform
}

#map,#adminMap{height:400px;width:100%}

/* Легенда */
.legend{
    position:absolute;
    top:10px;
    right:10px;
    background:rgba(255,255,255,0.95);
    border-radius:10px;
    padding:10px;
    backdrop-filter:blur(10px);
    box-shadow:0 4px 20px rgba(0,0,0,0.1);
    z-index:1000
}

.legend-item{
    display:flex;
    align-items:center;
    margin-bottom:5px;
    font-size:0.9rem
}

.legend-item:last-child{margin-bottom:0}

.legend-dot{
    width:12px;
    height:12px;
    border-radius:50%;
    margin-right:8px;
    border:2px solid white;
    box-shadow:0 2px 4px rgba(0,0,0,0.2)
}

.legend-dot.green{background:#4CAF50}
.legend-dot.red{background:#f44336}

/* Супербыстрая кнопка обновления */
.refresh-btn{
    position:fixed;
    bottom:20px;
    right:20px;
    width:60px;
    height:60px;
    background:linear-gradient(45deg,#667eea,#764ba2);
    border-radius:50%;
    display:flex;
    align-items:center;
    justify-content:center;
    color:white;
    font-size:1.5rem;
    cursor:pointer;
    box-shadow:0 4px 20px rgba(102,126,234,0.4);
    z-index:1000;
    will-change:transform;
    transition:transform 0.2s ease
}

.refresh-btn:hover{transform:scale(1.05)}
.refresh-btn:active{transform:scale(0.95)}

/* Формы */
.form-container{
    background:rgba(255,255,255,0.95);
    border-radius:20px;
    padding:30px;
    margin-bottom:20px;
    backdrop-filter:blur(10px);
    box-shadow:0 8px 32px rgba(0,0,0,0.1)
}

.form-group{margin-bottom:20px}

.form-group label{
    display:block;
    margin-bottom:8px;
    font-weight:600;
    color:#333
}

input,textarea,select{
    width:100%;
    padding:15px;
    border:2px solid #ddd;
    border-radius:12px;
    font-size:1rem;
    transition:border-color 0.2s ease;
    background:white
}

input:focus,textarea:focus,select:focus{
    outline:none;
    border-color:#667eea;
    box-shadow:0 0 0 3px rgba(102,126,234,0.1)
}

button{
    background:linear-gradient(45deg,#667eea,#764ba2);
    color:white;
    border:none;
    padding:15px 30px;
    border-radius:12px;
    font-size:1rem;
    font-weight:600;
    cursor:pointer;
    transition:transform 0.2s ease;
    width:100%;
    margin-top:10px;
    will-change:transform
}

button:hover:not(:disabled){transform:translateY(-2px)}
button:active:not(:disabled){transform:translateY(0)}
button:disabled{opacity:0.6;cursor:not-allowed;transform:none}

/* Админ панель */
.admin-controls{
    background:rgba(255,255,255,0.95);
    border-radius:15px;
    padding:20px;
    margin-bottom:20px;
    backdrop-filter:blur(10px);
    box-shadow:0 4px 20px rgba(0,0,0,0.1)
}

.admin-stats{justify-content:space-between}

#addModeBtn{background:#4CAF50;width:auto;margin:0}
#addModeBtn.active{background:#f44336}

.points-list{
    background:rgba(255,255,255,0.95);
    border-radius:15px;
    padding:20px;
    backdrop-filter:blur(10px);
    box-shadow:0 4px 20px rgba(0,0,0,0.1)
}

.point-item{
    background:#f8f9fa;
    border-radius:10px;
    padding:15px;
    margin-bottom:10px;
    border-left:4px solid #667eea;
    transition:transform 0.2s ease
}

.point-item:hover{transform:translateY(-1px)}
.point-item.collected{border-left-color:#f44336}
.point-item.scheduled{border-left-color:#ff9800}

/* Быстрые модальные окна */
.modal{
    display:none;
    position:fixed;
    z-index:2000;
    left:0;
    top:0;
    width:100%;
    height:100%;
    background-color:rgba(0,0,0,0.5);
    backdrop-filter:blur(3px)
}

.modal-content{
    background:white;
    margin:5% auto;
    padding:30px;
    border-radius:20px;
    width:90%;
    max-width:500px;
    position:relative;
    box-shadow:0 20px 60px rgba(0,0,0,0.3);
    max-height:80vh;
    overflow-y:auto;
    animation:modalIn 0.3s ease
}

@keyframes modalIn{
    from{transform:translateY(50px);opacity:0}
    to{transform:translateY(0);opacity:1}
}

.close{
    color:#aaa;
    float:right;
    font-size:28px;
    font-weight:bold;
    cursor:pointer;
    position:absolute;
    top:15px;
    right:20px;
    transition:color 0.2s ease
}

.close:hover{color:#000}

/* Сбор модели */
.collect-container{max-width:500px}

.model-info{
    text-align:center;
    margin-bottom:30px;
    padding:20px;
    background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);
    border-radius:15px;
    color:white
}

.collect-btn{
    background:linear-gradient(45deg,#4CAF50,#45a049);
    font-size:1.1rem;
    padding:18px
}

/* Превью изображения */
#imagePreview img{
    max-width:100%;
    max-height:200px;
    border-radius:10px;
    box-shadow:0 4px 15px rgba(0,0,0,0.1);
    margin-top:10px
}

/* Сообщения */
.success-message,.error-message{
    text-align:center;
    padding:40px;
    background:rgba(255,255,255,0.95);
    border-radius:20px;
    backdrop-filter:blur(10px);
    box-shadow:0 8px 32px rgba(0,0,0,0.1);
    animation:modalIn 0.5s ease
}

.success-message h2{color:#4CAF50;margin-bottom:15px}
.error-message h2{color:#f44336;margin-bottom:15px}
.success-message p,.error-message p{margin-bottom:10px;color:#666}

/* QR код */
#qrCodeDisplay{text-align:center;margin:20px 0}
#qrCodeDisplay img{
    max-width:250px;
    border-radius:10px;
    box-shadow:0 4px 15px rgba(0,0,0,0.1)
}

/* Мобильная адаптация */
@media (max-width:768px){
    .container{padding:8px}
    .header h1{font-size:2rem}
    .header p{font-size:1rem}
    #map,#adminMap{height:300px}
    .modal-content{margin:10% auto;width:95%;padding:20px}
    .stats{padding:12px}
    .stat-number{font-size:1.5rem}
    .refresh-btn{width:50px;height:50px;bottom:15px;right:15px;font-size:1.2rem}
}

@media (max-width:480px){
    .header{padding:15px;margin-bottom:15px}
    .header h1{font-size:1.8rem}
    .form-container{padding:20px}
    input,textarea{padding:12px}
    button{padding:12px 20px}
}

/* Производительность */
*{-webkit-tap-highlight-color:transparent}
.leaflet-container{font-family:inherit}

/* Оптимизация для touch устройств */
@media (hover:none) and (pointer:coarse){
    button:hover{transform:none}
    .refresh-btn:hover{transform:none}
    .point-item:hover{transform:none}
    .stat-number{transition:none}
}

/* Кастомные стили для маркеров уже в JS */

/* Дополнительные оптимизации */
.point-header{
    display:flex;
    justify-content:space-between;
    align-items:center;
    margin-bottom:10px
}

.point-header h4{margin:0;color:#333}
.point-status{font-size:0.9rem;font-weight:600}
.point-actions{
    margin-top:10px;
    padding-top:10px;
    border-top:1px solid #eee
}

.admin-btn{
    background:#667eea;
    color:white;
    border:none;
    padding:8px 12px;
    border-radius:6px;
    cursor:pointer;
    font-size:0.8rem;
    margin:5px 5px 0 0;
    min-width:80px;
    transition:background 0.2s ease
}

.admin-btn:hover{background:#5a67d8}
.delete-btn{background:#f44336!important}
.delete-btn:hover{background:#d32f2f!important}
